/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/ 
var OmexBasePage=function(){function a(){$(document).ready(this.onReady)}a.prototype.onReady=function(){};return a}(),SearchBox=function(){var h="unchangedSearchTerm",g="changedSearchTerm",b="focused",d=".searchShared",c=".search",e="#searchTerm",f="use strict";function a(){f;$(function(){var i="margin-top",h="undefined",k="#searchImage",j="wacClient",f=$(e);if(f.val()===SearchInfo)a.SetUnchanged(f);else a.SetChanged(f);if(SearchUrl.indexOf("client=WAC_")!==-1){$(c).addClass(j);$(d).addClass(j)}f.bind({focus:function(){a.ShowClearButton();if(f.val()===SearchInfo){f.val("");a.SetChanged(f)}},blur:function(){a.HideClearButton();if(f.val()===""){f.val(SearchInfo);a.SetUnchanged(f)}},keypress:function(b){b.which===13&&a.PerformSearch(b)}});$("#clearSearchTerm").bind("mousedown",function(g){var e=$(c).hasClass(b)||$(d).hasClass(b);e&&f.val("");f.focus();a.PerformSearch(g)});$(k).click(function(b){a.PerformSearch(b)});if(typeof window["external"]!==h&&typeof window.external.CancelDialog!==h){var p=$(window).width();if(p>800){var g=Math.round((p-600)/200);a.UpdateHeight($(c),g);a.UpdateHeight($(d),g);var o=$(".wrapper");a.UpdateHeight(o,g);a.UpdateWidth(o,g);var n=$(e);a.UpdateHeight(n,g);a.UpdateWidth(n,g);var m=$(k),q=m.css(i),l=parseInt(q.replace("px",""));l+=2*(g+1);m.css(i,l+"px")}}})}a.UpdateHeight=function(a,c){var b=a.height();b+=4*(c+1);a.height(b)};a.UpdateWidth=function(a,c){var b=a.width();b+=25*(c+1);a.width(b)};a.PerformSearch=function(d){f;var b;if(a.IsChanged($(e)))b=$(e).val();else b="";var c="&";if(SearchUrl.indexOf("?")===-1)c="?";b=b.replace(/[&\/\\#,()$~%.'":*?<>{}]/g," ");window.location.href=SearchUrl+c+"qu="+encodeURIComponent(b);d.preventDefault()};a.SetChanged=function(a){a.addClass(g);a.removeClass(h)};a.SetUnchanged=function(a){a.addClass(h);a.removeClass(g)};a.IsChanged=function(a){return a.val()!==SearchInfo};a.ShowClearButton=function(){$(c).addClass(b);$(d).addClass(b)};a.HideClearButton=function(){$(c).removeClass(b);$(d).removeClass(b)};return a}();new SearchBox;String.prototype.format=function(){for(var b=[],a=0;a<arguments.length;a++)b[a-0]=arguments[a];return this.replace(/{(\d+)}/g,function(c,a){return typeof b[a]!=="undefined"?b[a]:c})};String.prototype.addOrReplaceQueryParameter=function(b,c){var a=this;if(!b||!c){Diag.ULS.sendTraceTag(8946497,1500,Diag.ULSTraceLevel.error,"string.AddOrReplaceQueryParameter called with a null or empty parameter");return a}if(a.indexOf(b)===-1){var d=a.indexOf("?")===-1?"?":"&";return a+d+b+"="+c}else return a.replaceParams(b,c)};String.prototype.replaceParams=function(h,e){var a=this;if(!h)return a;var d="",g="",k=a.indexOf("#");if(k!==-1){g=a.substr(k);d=a.replace(g,"").toUpperCase()}else d=a.toUpperCase();var j=h.toUpperCase(),b=d.indexOf("?"+j+"=");if(b<0)b=d.indexOf("&"+j+"=");if(b<0)return a;var i=d.indexOf("&",b+1);if(i<0)b--;var c=a.substring(0,b+1);if(i>=0)c+=a.substring(i+1,a.length);if(typeof e!="undefined"&&null!=e&&e.length>0){var f=c.indexOf("?")<0?"?":"&";if(c.charAt(c.length-1)==f)f="";c+=f+h+"="+e}return c+g};String.prototype.endsWith=function(a){return this.indexOf(a,this.length-a.length)!==-1};String.prototype.replaceAll=function(b,a){if(typeof a==="undefined"||a===null)a="";return this.replace(new RegExp(b,"g"),a)};var g_ckeFrmStored="frmstored",g_htFormField={};function mSetCookie(f,e){var a=null;for(var l=[],d=2;d<arguments.length;d++)l[d-2]=arguments[d];var b=mSetCookie.arguments,c=mSetCookie.arguments.length,j=c>2?b[2]:false,g=c>3?b[3]:a,i=c>4?b[4]:"/",h=c>5?b[5]:a,k=c>6?b[6]:false;if(j&&""!=GetCookie(f))e=GetCookie(f)+","+e;document.cookie=f+"="+e+(g==a?"":"; expires="+g.toGMTString())+(i==a?"":"; path="+i)+(h==a?"":"; domain="+h)+(k==true?"; secure":"");return}function mDeleteCookie(b){var a=new Date;a.setDate(a.getDate()-10);mSetCookie(b,"",false,a)}function GetCookie(f,b){if("undefined"==typeof b)b="";var e=f+"=",h=e.length,g=document.cookie.length,a=0;while(a<g){var d=a+h;if(document.cookie.substring(a,d)==e){var c=document.cookie.indexOf(";",d);if(c==-1)c=document.cookie.length;return decodeURI(document.cookie.substring(d,c))}a=document.cookie.indexOf(" ",a)+1;if(a==0)break}return b}function StrRemoveParameterFromUrl(b,a){return b.replaceParams(a)}function StrGetQueryParamValue(b,a){var c=new RegExp("[\\?&]"+a+"=([^&#]*)","i");if(!c.test(b))return null;return c.exec(b)[0].substring(a.length+2)}function GetStringForCanaryGuidForCookie(a){return GetCookie(a,"")}function StoreFormFieldInCookie(a){if(a.type=="checkbox")g_htFormField[a.id]=a.checked;else g_htFormField[a.id]=a.value;mSetCookie(g_ckeFrmStored,JSON.stringify(g_htFormField))}function PreFillFormFromCookie(){var c=GetCookie(g_ckeFrmStored);if(c==null||c.length==0)return;try{g_htFormField=JSON.parse(c);var a="";for(a in g_htFormField){var b=$("#"+a);if(b.length>0&&b[0].type=="checkbox")b.attr("checked",g_htFormField[a]);else g_htFormField[a].length>0&&b.val(g_htFormField[a])}}catch(d){}}var SearchFeedbackType;(function(a){var d="Extended",c="Dissatisfied",b="Satisfied";a[a["None"]=0]="None";a[a[b]=1]=b;a[a[c]=2]=c;a[a[d]=3]=d})(SearchFeedbackType||(SearchFeedbackType={}));var SearchFeedbackControlHandler=function(){var g="query: '",c="#HeaderRow",d="#TextContainer",b="#Submit",f="#Dissatisfied",e="#Satisfied";function a(){var a=this;a.fastAnimationSpeed=50;a.expandSpeed=200;a.scrollIntoViewSpeed=225;a.finalFadeDelay=2e3;a.finalFadeSpeed=1e3;a.type=0}a.prototype.init=function(){var a=this;$(e).click(function(){a.type=1;a.actionClicked(a.type)});$(f).click(function(){a.type=2;a.actionClicked(a.type)});$("#More").click(function(){a.type=3;a.actionClicked(a.type)});$(b).click(function(){a.submitFullFeedback(a.type)})};a.prototype.actionClicked=function(){var a=this;this.toggleInput(function(){a.whenExpanded(function(){return a.submitShortFeedback(a.type)})})};a.prototype.toggleInput=function(c){var a=this;$(b).toggle(5,function(){a.whenCollapsed(function(){return a.focusHeader()});$(d).slideToggle(a.expandSpeed,function(){a.whenExpanded(function(){return a.focusFeedback()});c()})})};a.prototype.whenExpanded=function(a){this.isExpanded()&&a()};a.prototype.whenCollapsed=function(a){!this.isExpanded()&&a()};a.prototype.isExpanded=function(){return $(b).css("display")!=="none"};a.prototype.focusHeader=function(){this.focusSmoothly($(c))};a.prototype.focusFeedback=function(){this.focusSmoothly($(b))};a.prototype.focusResults=function(){this.focusSmoothly($("#PageTabsAfter"))};a.prototype.focusSmoothly=function(a){var c=a.offset(),b=a.height();$("html, body").animate({scrollTop:Math.max(c.top-$(window).height()+b+10,0)},this.scrollIntoViewSpeed)};a.prototype.submitShortFeedback=function(a){this.submitShortFeedbackData(a)};a.prototype.submitFullFeedback=function(a){this.transitionToFinal();this.submitFullFeedbackData(a)};a.prototype.transitionToFinal=function(){var b="#SearchFeedbackControl",a=this,e=a;a.hideInput();var d=$(c).width();$("#Question").text(searchFeedbackThanksText);a.hideActionItems();a.focusHeader();$(b).width(d);$(c).addClass("row-header-final");$("#QuestionContainer").addClass("question-item-final");$(b).delay(a.finalFadeDelay).fadeOut(a.finalFadeSpeed);setTimeout(function(){return e.focusResults()},a.finalFadeDelay)};a.prototype.hideInput=function(){var a="visibility";$(b).css(a,"hidden");$(d).css(a,"hidden")};a.prototype.hideActionItems=function(){$(e).hide(this.fastAnimationSpeed);$(f).hide(this.fastAnimationSpeed);$("#More").hide(this.fastAnimationSpeed)};a.prototype.submitShortFeedbackData=function(b){var a="Short search feedback for "+g+searchFeedbackQuery+"'. type: '"+SearchFeedbackType[b]+"'";AnalyticsLoggingObject.SendCustomMessageWithTag(a,searchFeedbackShortTag)};a.prototype.submitFullFeedbackData=function(b){var a="Full search feedback for "+g+searchFeedbackQuery+"'. type: '"+SearchFeedbackType[b]+"', message: '"+$("#FeedbackText").val()+"'";AnalyticsLoggingObject.SendCustomMessageWithTag(a,searchFeedbackFullTag)};a.prototype.setCookie=function(){var a=new Date;a.setFullYear(a.getFullYear()+1);mSetCookie(searchFeedbackCookieName,"value",false,a,"/")};return a}(),TabbedPagination=function(){var b="-",h="#LinkAfter",g="#LinkBefore",d="tabid",e=".oxTab",f="click",a="use strict";function c(e){var b=this;a;b.m_action=e;b.m_currentPage=Page;b.m_currentSortOrder=SortOrder;b.m_currentSortDirection=[];for(var c=0;c<TabContents.length;c++)if(b.m_currentSortOrder===c&&TabContents[c].length>1)b.m_currentSortDirection[c]=SortDirection;else b.m_currentSortDirection[c]=0;b.m_action();var d=b;$(function(){d.AddLinkEventHandlers();d.AddTabEventHandlers()});b.InterpretHashParameters();$(window).bind("hashchange",function(){d.InterpretHashParameters()})}c.prototype.AddLinkEventHandlers=function(){a;var b=this;$(".oxPageNext").bind(f,function(a){b.m_currentPage++;b.m_wasLinkClicked=true;b.UpdateHashParameters();a.preventDefault()});$(".oxPagePrev").bind(f,function(a){if(b.m_currentPage>0){b.m_currentPage--;b.m_wasLinkClicked=true;b.UpdateHashParameters();a.preventDefault()}})};c.prototype.AddTabEventHandlers=function(){a;var b=this;$(e).bind(f,function(c){var a=$(c.target).data(d);if(a===b.m_currentSortOrder&&TabContents[a].length>1)if(b.m_currentSortDirection[a]===0)b.SetSortDirection(1);else b.SetSortDirection(0);b.m_currentPage=0;b.m_currentSortOrder=a;$(e).each(function(f,e){var a="oxTabSelected",c=$(e);if(c.data(d)===b.m_currentSortOrder)c.addClass(a);else c.hasClass(a)&&c.removeClass(a);return c});b.UpdateHashParameters();c.preventDefault()})};c.prototype.PageChange=function(){var d='" /></span>',b=this;a;b.AddLinkEventHandlers();if(b.m_currentPage===0)b.UpdatePage(b.GetTabContents(),Link);else{var c=Parameters;c.page=b.m_currentPage;c.order=b.m_currentSortOrder;c.direction=b.m_currentSortDirection[b.m_currentSortOrder];c.skip=SkipToPage;var e=b;$.ajax({type:"POST",url:Url,data:c,complete:function(a){e.AjaxComplete(a)}});$(g).replaceWith('<span id="LinkBefore"><img id="LinkBeforeLoading" class="oxPaginationLink" src="images/general/loading.gif" width="12" height="12" alt="'+Loading+d);$(h).replaceWith('<span id="LinkAfter"><img id="LinkAfterLoading" class="oxPaginationLink" src="images/general/loading.gif" width="12" height="12" alt="'+Loading+d)}};c.prototype.AjaxComplete=function(e){var b=this;a;var c;try{c=$.parseJSON(e.responseText)}catch(d){b.m_currentPage=0;b.m_currentSortOrder=0;b.SetSortDirection(0);b.UpdatePage(b.GetTabContents(),Link);return}b.m_currentPage=c.Page;b.m_currentSortOrder=c.SortOrder;b.SetSortDirection(c.SortDirection);b.UpdatePage(c.Items,c.Link)};c.prototype.UpdatePage=function(m,i){var b="height",d="#PageItems",e=this;a;var f=$("<div>"+m+"</div>"),c=$(d),j=c.css(b);c.after(f.prop("id","PageItemsTemp").css("visibility","none"));e.m_action();var l=$("#PageItemsTemp"),k=l.css(b);c.replaceWith(f.prop("id","PageItems").css(b,j));c=$(d);c.animate({height:k},"fast","swing",function(){c.css(b,"auto")});$(g).replaceWith(i.replace(/\{ID\}/g,"Before"));$(h).replaceWith(i.replace(/\{ID\}/g,"After"));e.AddLinkEventHandlers();if(e.m_wasLinkClicked){$("html, body").animate({scrollTop:$("#TabbedPage").offset().top},"fast");e.m_wasLinkClicked=false}};c.prototype.UpdateHashParameters=function(){var c=this;a;window.location.hash="#"+c.m_currentPage+b+c.m_currentSortOrder+b+c.m_currentSortDirection[c.m_currentSortOrder]};c.prototype.InterpretHashParameters=function(){var f=this;a;var c=window.location.hash.substring(1),g=parseInt(c.substring(0,c.indexOf(b))),e=parseInt(c.substring(c.indexOf(b)+1,c.lastIndexOf(b))),d=parseInt(c.substring(c.lastIndexOf(b)+1));if(!isNaN(g)&&!isNaN(e)&&!isNaN(d)&&g>=0&&e>=0&&e<TabContents.length&&d>=0&&d<=1){f.m_currentPage=g;f.m_currentSortOrder=e;f.SetSortDirection(d);f.PageChange()}};c.prototype.GetTabContents=function(){a;return TabContents[this.m_currentSortOrder][this.m_currentSortDirection[this.m_currentSortOrder]]};c.prototype.SetSortDirection=function(b){a;this.m_currentSortDirection[this.m_currentSortOrder]=b;var c=this;$(e).each(function(g,f){var e=$(f);if(e.data(d)===c.m_currentSortOrder){var a=e.children(".oxTabDirection");if(b===0){a.prop("src","images/tabbedpagination/ascending.png");a.prop("alt",Ascending)}else{a.prop("src","images/tabbedpagination/descending.png");a.prop("alt",Descending)}}return e})};return c}(),__extends=this.__extends||function(b,a){for(var c in a)if(a.hasOwnProperty(c))b[c]=a[c];function d(){this.constructor=b}d.prototype=a.prototype;b.prototype=new d},SearchPage=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.onReady=function(){var a=new SearchFeedbackControlHandler;a.init()};return a}(OmexBasePage);new SearchPage